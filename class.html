<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>TongBei 产品列表</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/weui.min.css">
        <link rel="stylesheet" href="css/jquery-weui.min.css">
        <link rel="stylesheet" href="css/bootstrap.min.css" >
        <link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/class.css">
        <link rel="stylesheet" href="css/theme-color.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>
    <body>
        <header class="zyw-header">
            <div class="zyw-container white-color">
                <div class="head-l"><a href="javascript:window.history.back(-1)" target="_self"><img src="img/svg/head-return.svg" alt=""></a></div>
                <div class="head-search">
                    <i class="fa fa-search" aria-hidden="true"></i>
                    <input type="text" placeholder="输入您当前要搜索的产品" class="white-color">
                </div>
                <!--<div class="head-r"><a href="">取消</a></div>-->
            </div>
        </header>
        <footer class="zyw-footer">
            <div class="zyw-container white-bgcolor clearfix">
                <div class="weui-tabbar">
                    <a href="index.html" class="weui-tabbar__item ">
                        <div class="weui-tabbar__icon">
                            <img src="./img/svg/foot-1.svg" alt="">
                        </div>
                        <p class="weui-tabbar__label">首页</p>
                    </a>
                    <a href="class.html" class="weui-tabbar__item">
                        <div class="weui-tabbar__icon">
                            <img src="./img/svg/foot-2-1.svg" alt="">
                        </div>
                        <p class="weui-tabbar__label">分类</p>
                    </a>
                    <a href="cart.html" class="weui-tabbar__item">
                        <!--<span class="weui-badge" style="position: absolute;top: -.4em;right: 1em;">8</span>-->
                        <div class="weui-tabbar__icon">
                            <img src="./img/svg/foot-4.svg" alt="">
                        </div>
                        <p class="weui-tabbar__label">回收车</p>
                    </a>
                    <a href="home.html" class="weui-tabbar__item">
                        <div class="weui-tabbar__icon">
                            <img src="./img/svg/foot-5.svg" alt="">
                        </div>
                        <p class="weui-tabbar__label">个人中心</p>
                    </a>
                </div>
            </div>
        </footer>
        <section class="zyw-container">
            <div class="content">
                <div class="left" id="left">
                    <div class="swiper-container">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide">
                                <ul id="proType">
                                    <!--<li> 类型1 </li>
                                    <li> 类型2 </li>
                                    <li> 类型3 </li>
                                    <li> 类型4 </li>
                                    <li> 类型5 </li>-->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="right" id="right">
                    <div class="swiper-container">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide">
                                <ul id="ProList">
                                        <!--<li>
                                            <div class="class-title">类型1</div>
                                            <div>
                                                    <div class="item">
                                                        <div class="item-left">
                                                            <div class="item-img"></div>
                                                        </div>
                                                        <div class="item-right">
                                                            <div class="title">产品1</div>
                                                            <div class="subtitle"></div>
                                                            <div class="price"></div>
                                                        </div>
                                                    </div>
                                            </div>
                                        </li>-->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-slide" style="display:none;">
            店铺介绍
            </div>
        </section>
        <script src="js/jquery.js"></script>
        <script type="text/javascript">
            
            $(function(){
                $.ajax({
                	type:"post",
                	url:"php/class.php",
                	async:true,
                	dataType:'json',
                	success:function(data){
                	    //显示产品类型
                	    for (var i=0;i<data['type'].length;i++) {
                	    	var TypeText = "<li> "+data['type'][i]['name']+" </li>"
                	    	$('#proType').append(TypeText)
                	    	//显示产品
                	    	var ProText = "<li>"
                	    	ProText += "<div class='class-title'>"+data['type'][i]['name']+"</div>"
                            ProText += "<div>"
                            var ProTyprId = data['type'][i]['id']
                	    	for (var y=0;y<data[ProTyprId].length;y++) {
                                ProText += "<div class='item'>"
                                ProText += "<div class='item-left'>"
                                ProText += "<img class='item-img' src='"+data[ProTyprId][y]['url']+"' />"
                                ProText += "</div>"
                                ProText += "<div class='item-right'>"
                                ProText += "<div class='title'>"+data[ProTyprId][y]['name']+"</div>"
                                ProText += "<div class='subtitle'>"+data[ProTyprId][y]['else']+"</div>"
                                ProText += "<div class='price'>¥"+data[ProTyprId][y]['price']+'/'+data[ProTyprId][y]['unit']+"</div>"
                                ProText += "</div>"
                                ProText += "</div>"
                	    	}
                	    	ProText += "</div>"
                            ProText += "</li>"
                	    	$('#ProList').append(ProText)
                	    }
                	    
                	    //初始化
                	    $('.content').css('height',$('.right').height());
                        $('.left ul li').eq(0).addClass('active');
                        $(window).scroll(function(){
                            if($(window).scrollTop() >= 150){
                                $('.swiper-container-ul').css('position','fixed');
                                $('.left').css('position','fixed');
                                $('.right').css('margin-left',$('.left').width());
                            }else {
                                $('.swiper-container-ul').css('position','');
                                $('.left').css('position','');
                                $('.right').css('margin-left','');
                            };
                            //滚动到标杆位置,左侧导航加active
                            $('.right ul li').each(function(){
                                var target = parseInt($(this).offset().top-$(window).scrollTop()-150);
                                var i = $(this).index();
                                if (target<=0) {
                                    $('.left ul li').removeClass('active');
                                    $('.left ul li').eq(i).addClass('active');
                                }
                            });
                        });
                        $('.left ul li').click(function(){
                            var i = $(this).index('.left ul li');
                            $('body, html').animate({scrollTop:$('.right ul li').eq(i).offset().top-40},500);
                        });
                        $('.swiper-container-ul-li').click(function(){
                            var index = $(this).index();
                            if(index == 0){
                                $('.swiper-slide').eq(0).show();
                                $('.swiper-container-ul-li').eq(0).addClass('actives');
                                $('.swiper-slide').eq(1).hide();
                                $('.swiper-container-ul-li').eq(1).removeClass('actives');
                            }else {
                                $('.swiper-slide').eq(0).hide();
                                $('.swiper-container-ul-li').eq(0).removeClass('actives');
                                $('.swiper-slide').eq(1).show();
                                $('.swiper-container-ul-li').eq(1).addClass('actives');
                            }
                        });
                	},
                	error:function(s,e,t){
                	    alert('出现错误，错误原因：'+e)
                	}
                });
                
            });
        </script>
    </body>
</html>