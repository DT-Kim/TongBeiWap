<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>TongBei 首页</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/weui.min.css">
    <link rel="stylesheet" href="css/jquery-weui.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css" >
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/swiper.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/theme-color.css">
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <style>
		.div_right {display:flex; bottom: 10px; right: 4%; border: solid 1px #e6e6e6; border-radius: 4px; width: 82px; overflow: hidden; text-align: center; line-height: 30px; }
		.div_right i { float: left; width: 33%; color: #333; font-style: normal;}
		.div_right span { float: left; width: 33%; border-left: solid 1px #e6e6e6; border-right: solid 1px #e6e6e6; color: #333; }

        /*.select_list li .calc {display:flex;width: 100%; justify-content: flex-end; align-items: center; flex-wrap: nowrap; margin-right: 0px;}*/
        /*.select_list li .calc p{ width: 2rem; height: 2.0rem; margin:1px 2%;border-radius: 1.8rem; overflow: hidden; text-align: center; line-height: 1.6rem;font-size: 1.6rem;}*/
        /*.select_list li .calc .item_sub{  no-repeat; background-size: contain; }*/
        /*.select_list li .calc .item_add{  no-repeat; background-size: contain; }*/
    </style>
</head>
<body>
<header class="zyw-header">
    <div class="zyw-container white-color">
        <div class="head-l"><a href="javascript:window.history.back(-1)" target="_self"><img src="img/svg/head-return.svg" alt=""></a></div>
        <div class="head-search">
            <i class="fa fa-search" aria-hidden="true"></i>
            <input type="text" placeholder="输入您当前要搜索的商品" class="white-color" autofocus="autofocus" onclick="search()">
        </div>
        <div class="head-r" id="submit">搜索</div>
    </div>
</header>
<!--底部菜单开始-->
<footer class="zyw-footer">
    <div class="zyw-container white-bgcolor clearfix">
        <div class="weui-tabbar">
            <a href="index.html" class="weui-tabbar__item">
                <div class="weui-tabbar__icon">
                    <img src="./img/svg/foot-1-1.svg" alt="">
                </div>
                <p class="weui-tabbar__label">首页</p>
            </a>
            <a href="class.html" class="weui-tabbar__item">
                <div class="weui-tabbar__icon">
                    <img src="./img/svg/foot-2.svg" alt="">
                </div>
                <p class="weui-tabbar__label">分类</p>
            </a>
            <a href="cart.html" class="weui-tabbar__item">
                <span class="weui-badge" style="position: absolute;top: -.4em;right: 1em;" id="count_num">8</span>
                <div class="weui-tabbar__icon">
                    <img src="./img/svg/foot-4.svg" alt="">
                </div>
                <p class="weui-tabbar__label">回收车</p>
            </a>
            <a href="home.html" class="weui-tabbar__item">
                <div class="weui-tabbar__icon">
                    <img src="./img/svg/foot-5.svg" alt="">
                </div>
                <p class="weui-tabbar__label">个人中心</p>
            </a>
        </div>
    </div>
</footer>
<!--底部菜单结束-->
<section class="zyw-container">
    <div class="index-wares">
        <div class="wares-cont">
            <ul class="clearfix" id="ProType">
                <!--<li class="col-sm-6 col-xs-6 ware-box">
                    <a href="item.html">
                        <div class="ware-img">
                            <img src="../TongBeiPC/ProType/01.jpg" alt="">
                        </div>
                        <h3 class="ware-title">产品一</h3>
                        <p class="ware-des">简介</p>
                    </a>
                </li>-->
            </ul>
        </div>
    </div>
   <!--热门搜索和历史搜索-->
<!--<div id="yc">
	    <div class="search-hot">
        <h4 class="search-hd">热门搜索</h4>
        <ul class="search-hot-bd clearfix">
            <li><a href="">iPhone X</a></li>
            <li><a href="">ThinkPad 家庭版 2017</a></li>
            <li><a href="">ThinkPad i5</a></li>
            <li><a href=""></a>加湿器</li>
            <li><a href=""></a>iPhone6s 手机壳</li>
            <li><a href=""></a>罗技鼠标键盘套装</li>
        </ul>
    </div>
    <div class="search-history">
        <h4 class="search-hd">历史搜索</h4>
        <ul class="search-history-bd white-bgcolor">
            <li><a href=""><i class="fa fa-clock-o theme-color" aria-hidden="true"></i> 女装连衣裙冬季长袖</a></li>
            <li><a href=""><i class="fa fa-clock-o theme-color" aria-hidden="true"></i> 卸妆水</a></li>
            <li><a href=""><i class="fa fa-clock-o theme-color" aria-hidden="true"></i> 三只松鼠夏威夷果</a></li>
        </ul>
    </div>
</div>-->
    <!--限时活动-->
    <div class="index-wares">
        <div class="wares-cont">
            <ul class="clearfix select_list" id="ProList">
                    <!--<li class="col-sm-6 col-xs-6 ware-box">
                        <div class="ware-img">
                            <img src="01.jpg" alt="">
                        </div>
                        <h3 class="ware-title">产品一</h3>
                        <p class="ware-des">简介</p>
                        <span class="ware-prince red-color">￥8088.00</span>
                        <div class="calc">
                            <p class="item_sub" onclick="num_sub(this)"></p>
                            <p class="item_num">10</p>
                            <p class="item_add" onclick="num_add(this)"></p>
                        </div>
                    </li>-->
            </ul>
        </div>
    </div>
</section>
<script src="js/jquery.min.js"></script>
<script src="js/jquery-weui.min.js"></script>
<script src="js/swiper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript">
	function search(){
		window.location.href="search.html";
	}
    var count_num = 0;
    var parice = 0;
    var this_parice;
    var this_num;
    //加
    function num_add(on_this){
//        当前商品数量
        count_num++;
        $('#count_num').html(count_num);
        this_num = $(on_this).parent().parent().children('.calc').children('.item_num');
        var get_this_num = parseInt(this_num.text())+1;
        this_num.html(get_this_num);
        this_num.parent().addClass('select');
        changeNum(on_this,get_this_num)
    }
    //减
    function num_sub(on_this){
	this_num = $(on_this).parent().parent().children('.calc').children('.item_num');
	if(parseInt(this_num.text())>0){
		//        当前商品数量
		count_num--;
        $('#count_num').html(count_num);
        this_num = $(on_this).parent().parent().children('.calc').children('.item_num');
        var get_this_num = parseInt(this_num.text())-1;
        this_num.html(get_this_num);
        if(get_this_num == 0){
            this_num.parent().removeClass('select');
        }
        changeNum(on_this,get_this_num);
		}
    }
    //改变数据
    function changeNum (obj,num){
        //获取id
        var proId = $(obj).parent().parent().children('.calc').children('.proId');
//      alert(proId.text())
//      alert(num)
        $.ajax({
        	type:"post",
        	url:"php/NumChange.php",
        	async:true,
        	data:{
        	    proId:proId.text(),
        	    num:num
        	},
        	success:function(data){
//      	    console.log(data)
        	},
        	error:function(s,e,t){
        	    alert('出现错误，错误类型'+e)
        	}
        });
    }
    $("#submit").click(function(){
//      alert(getQueryString('data'))
        // 获取页面信息
        $.ajax({
            type:"post",
            url:"php/index.php",
            async:true,
            dataType:'json',
            success:function(data){
                //创建产品
//              val ssk = $('.head-search input').val();
                for (var i=0;i<data['pro'].length;i++) {
                	if(data['pro'][i]['name'].indexOf($('.head-search input').val()) != -1 ){
	                    var EleText = "<li class='col-sm-6 col-xs-6 ware-box'>"
	                    EleText += "<a href='item.html?ProId="+data['pro'][i]['id']+"'>"
	                    EleText += "<div class='ware-img'>"
	                    EleText += "<img src='"+data['pro'][i]['url']+"'>"
	                    EleText += "</div>"
	                    EleText += "<h3 class='ware-title'>"+data['pro'][i]['name']+"</h3>"
	                    EleText += "<p class='ware-des'>"+data['pro'][i]['else']+"</p>"
	                    EleText += "<span class='ware-prince red-color'>"+data['pro'][i]['price']+"</span>" 
	                    EleText += "</a>"
	                    EleText += "<div class='calc select div_right'>"                   
	                    EleText += "<p class='proId' hidden='hidden'>"+data['pro'][i]['id']+"</p>"
	                    EleText += "<i onclick='num_sub(this)' class='item_sub'>-</i>" 
	                    EleText += "<span class='item_num'>"+data['pro'][i]['num']+"</span>"
	                    EleText += "<input type='hidden' value='84'>"
	                    EleText += "<i class='item_add' onclick='num_add(this)'>+</i>"                    
	                    EleText += "</div>"
	                    EleText += "</li>"
	                    
	                    count_num += parseInt(data['pro'][i]['num'])
	                    
	                    $('#ProList').append(EleText)                		
                	}

                    
                }
                
                $('#count_num').html(count_num)
                /*
                 * action
                 */
            },
            error:function(s,e,t){
                alert('出现错误，错误类型:'+e)
            }
        })
    })
    //获取url中的参数
	function getQueryString(name) {
        var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
        var r = window.location.search.substr(1).match(reg);
        if (r != null) {
            return unescape(r[2]);
        }
        return null;
    }
</script>
</body>
</html>